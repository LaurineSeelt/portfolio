[["working-with-dbeaver-and-sql.html", "9 Working with DBeaver and SQL", " 9 Working with DBeaver and SQL library(tidyverse) library(readxl) library(dslabs) library(here) First, I read in the flu, dengue and gapminder data. flu &lt;- read_csv(here(&quot;data/flu_data.csv&quot;), skip = 11) dengue &lt;- read_csv(here(&quot;data/dengue_data.csv&quot;), skip = 11) gapminder &lt;- read_builtin(&quot;gapminder&quot;) The flu and dengue data wasn’t tidy yet, so I solved that by using the pivot_longer command to create the column “country” and “cases” in each of the datasets. That way, each country, date and number of cases had its own column. The gapminder data was tidy already, so I didn’t change anything about that. dengue_tidy &lt;- pivot_longer(data = dengue, cols = c(&quot;Argentina&quot;, &quot;Bolivia&quot;, &quot;Brazil&quot;, &quot;India&quot;, &quot;Indonesia&quot;, &quot;Mexico&quot;, &quot;Philippines&quot;, &quot;Singapore&quot;, &quot;Thailand&quot;, &quot;Venezuela&quot;), names_to = &quot;country&quot;, values_to = &quot;dengue_cases&quot;) flu_tidy &lt;- pivot_longer(data = flu, cols = c(&quot;Argentina&quot;, &quot;Australia&quot;, &quot;Austria&quot;, &quot;Belgium&quot;, &quot;Bolivia&quot;, &quot;Brazil&quot;, &quot;Bulgaria&quot;, &quot;Canada&quot;, &quot;Chile&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Hungary&quot;, &quot;Japan&quot;, &quot;Mexico&quot;, &quot;Netherlands&quot;, &quot;New Zealand&quot;, &quot;Norway&quot;, &quot;Paraguay&quot;, &quot;Peru&quot;, &quot;Poland&quot;, &quot;Romania&quot;, &quot;Russia&quot;, &quot;South Africa&quot;, &quot;Spain&quot;, &quot;Sweden&quot;, &quot;Switzerland&quot;, &quot;Ukraine&quot;, &quot;United States&quot;, &quot;Uruguay&quot;), names_to = &quot;country&quot;, values_to = &quot;flu_cases&quot;) Next, I changed the flu and dengue data some more. I separated the Dat column into the three columns “Year”, “Month” and “Day”. flu_tidy &lt;- separate(flu_tidy, Date, into = c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;), sep = &quot;-&quot;) dengue_tidy&lt;- separate(dengue_tidy, Date, into = c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;), sep = &quot;-&quot;) flu_tidy$country &lt;- as.factor(flu_tidy$country) flu_tidy$year &lt;- as.numeric(flu_tidy$year) dengue_tidy$country &lt;- as.factor(dengue_tidy$country) dengue_tidy$year &lt;- as.numeric(dengue_tidy$year) dengue_tidy$month &lt;- as.numeric(dengue_tidy$month) dengue_tidy$day &lt;- as.numeric(dengue_tidy$day) gapminder$country &lt;- as.factor(gapminder$country) dengue_tidy &lt;- as.data.frame(dengue_tidy) # dengue_tidy &lt;- dengue_tidy %&gt;% group_by(year, country) %&gt;% summarise(mean_dengue_cases = mean(dengue_cases)) # flu_tidy &lt;- flu_tidy %&gt;% group_by(country, year) %&gt;% summarise(mean_flu_cases = mean(flu_cases)) dengue_tidy %&gt;% group_by(country, year) ## # A tibble: 6,590 × 5 ## # Groups: country, year [140] ## year month day country dengue_cases ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; ## 1 2002 12 29 Argentina NA ## 2 2002 12 29 Bolivia 0.101 ## 3 2002 12 29 Brazil 0.073 ## 4 2002 12 29 India 0.062 ## 5 2002 12 29 Indonesia 0.101 ## 6 2002 12 29 Mexico NA ## 7 2002 12 29 Philippines NA ## 8 2002 12 29 Singapore 0.059 ## 9 2002 12 29 Thailand NA ## 10 2002 12 29 Venezuela NA ## # … with 6,580 more rows "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
